doctype html
html(lang='en')

  head
    title xxx | xxx
    meta(name='description', content='xxx')
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1, shrink-to-fit=no')
    link(rel='shortcut icon', href='/favicon.ico', type='image/x-icon')
    meta(http-equiv='x-ua-compatible', content='ie=edge')
    link(href='//fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css' async)
    link(href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css' async)

    style.

      body {
        font-family:'Roboto',sans-serif;
        background-color:white;
        padding:0px;
        margin:0px;
      }

      .left-pannel {
        width:100%;
      }

      .right-pannel {
        display: none;
      }

      .roladex-header {
        padding:0px;
        margin:0px;
        width:100%;
      }

      .roladex-header-text {
        text-align:center;
        font-weight:600;
        font-size:2em;
        padding:22px;
        color:black;
        margin:0px;
      }

      .roladex-header-add-contact-button {
        background-color:transparent;
        border-radius:1em;
        position:absolute;
        line-height:2em;
        font-weight:600;
        cursor:pointer;
        font-size:2em;
        color:#1679f4;
        padding:0px;
        border:none;
        height:2em;
        width:2em;
        right:8%;
        top:6px;
      }

      .roladex-tab {
        border-bottom:3px solid gray;
        display:inline-block;
        cursor:pointer;
        width:50%;
      }

      .roladex-tab-selected {
        border-bottom:3px solid #1679f4;
        display:inline-block;
        cursor:pointer;
        width:50%;
      }

      .roladex-tab-text {
        text-align:center;
        font-size:1.2em;
        color:gray;
      }

      .roladex-tab-text-selected {
        text-align:center;
        font-size:1.2em;
        color:#1679f4;
      }


      .roladex-search-container {
        background-color:#fbfaff;
        position:relative;
        height:88px;
        width:100%;
      }

      .roladex-search-input {
        border: 1px solid #e4e0e1;
        border-radius:10px;
        text-indent:28px;
        font-size:1.2em;
        padding:11px;
        margin:5%;
        width:84%;
      }

      .roladex-search-input-left-icon {
        position:absolute;
        cursor:default;
        color:#757575;
        left:35px;
        top:35px;
      }

      .roladex-search-input-right-icon {
        position:absolute;
        cursor:pointer;
        color:#757575;
        right:35px;
        top:35px;
      }

      .contact-list-divider{
        background-color:#f3f3f3;
        padding-bottom:0.25em;
        padding-top:0.25em;
        padding-left:22px;
        font-size:1.5em;
        font-weight:700;
        color:#000;
        margin:0px;
        width:100%;
      }

      .contact-list-person-container {
        border-bottom:1px solid #f3f3f3;
        background-color:white;
        cursor:pointer;
        width:100%;
      }

      .contact-list-person-primary-text {
        display:inline-block;
        padding-left:22px;
        font-size:1.5em;
        font-weight:700;
      }

      .contact-list-person-secondary-text {
        display:inline-block;
        padding-left:8px;
        font-size:1.5em;
        font-weight:300;
      }

      .contact-card-container {
        width:calc(100% - 20% - 2px);
        border: 1px solid #d7d8e1;
        background-color:white;
        margin-bottom:5%;
        margin-left:7%;
        margin-top:4%;
      }


      @media screen and (min-width: 768px) and (max-width: 1024px) {
        .left-pannel {
          border-right:1px solid #d7d8e1;
          box-sizing:border-box;
          overflow:scroll;
          height:100vh;
          float:left;
          width:50%;
        }
        .right-pannel {
          border-left:1px solid #d7d8e1;
          background-color:#e8ebf2;
          box-sizing:border-box;
          display: inline;
          overflow:scroll;
          font-size:1em;
          height:100vh;
          float:right;
          width:50%;
        }
      }


      @media screen and (min-width: 1024px) {
        .left-pannel {
          border-right:1px solid #d7d8e1;
          box-sizing:border-box;
          overflow:scroll;
          height:100vh;
          float:left;
          width:30%;
        }
        .right-pannel {
          border-left:1px solid #d7d8e1;
          background-color:#e8ebf2;
          box-sizing:border-box;
          display: inline;
          overflow:scroll;
          font-size:1em;
          height:100vh;
          float:right;
          width:70%;
        }
      }


  body

    //------
    //-ROLADEX PANNEL
    //-------
    div(class="left-pannel")


      //------
      //-HEADER
      //-------
      div(id="roladexHeader" class="roladex-header")
        button(id="roladexHeaderAddContactButton" class="roladex-header-add-contact-button") +
        p(id="roladexHeaderText" class="roladex-header-text") Contacts


      //------
      //-TABS
      //-------
      if sortPrimary === 'givenName'
        div(id="roladexTabsGivenName" class="roladex-tab-selected" onclick="window.location.href='/?sort=givenName'")
          p(id="roladexTabsGivenNameText" class="roladex-tab-text-selected") First Name
        div(id="roladexTabsFamilyName" class="roladex-tab" onclick="window.location.href='/?sort=familyName'")
          p(id="roladexTabsFamilyNameText" class="roladex-tab-text") Last Name
      if sortPrimary === 'familyName'
        div(id="roladexTabsGivenName" class="roladex-tab" onclick="window.location.href='/?sort=givenName'")
          p(id="roladexTabsGivenNameText" class="roladex-tab-text") First Name
        div(id="roladexTabsFamilyName" class="roladex-tab-selected" onclick="window.location.href='/?sort=familyName'")
          p(id="roladexTabsFamilyNameText" class="roladex-tab-text-selected") Last Name


      //------
      //-SEARCH
      //-------
      div(id="roladexSearchContainer" class="roladex-search-container")
        span(id="roladexSearchInputLeftIcon" class="roladex-search-input-left-icon fa fa-search" aria-hidden="true")
        input(id="roladexSearchInput" class="roladex-search-input" placeholder="Search")
        span(id="roladexSearchInputRightIcon" class="roladex-search-input-right-icon fa fa-times-circle" aria-hidden="true")


      //------
      //-LIST
      //-------
      div(id='contactListContainer' class="contact-list-container")
        each person in people
          - let firstLetter = person[sortPrimary].charAt(0).toUpperCase();
          if alphabet.includes(firstLetter)
            - let charIndex = alphabet.indexOf(firstLetter);
            - let char = alphabet.splice(charIndex, 1);
            - alphabet = alphabet.filter(item => item !== char)
            //-DIVIDER
            p(class="contact-list-divider") #{char}
          div(id=person._id class="contact-list-person-container")
            span
              if sortPrimary === 'givenName'
                p(id="contactListPersonPrimaryText" class="contact-list-person-primary-text") #{person[sortPrimary]}
                p(id="contactListPersonSecondaryText" class="contact-list-person-secondary-text") #{person[sortSecondary]}
              if sortPrimary === 'familyName'
                p(id="contactListPersonPrimaryText" class="contact-list-person-primary-text") #{person[sortPrimary]},
                p(id="contactListPersonSecondaryText" class="contact-list-person-secondary-text") #{person[sortSecondary]}

      div(id='searchResultListContainer' hidden)


    //------
    //-CONTAINER
    //-------
    - let contact = people[0];
    div(class="right-pannel")
      //------
      //-CONTACT CARD
      //-------
      div(id="contactCardContainer" class="contact-card-container" style="width:calc(100% - 20% - 2px);margin-top:4%;margin-left:7%;margin-bottom:5%;border: 1px solid #d7d8e1;background-color:white")
        ////////
        //HEADER
        /////////
        div(style="width:100%;padding:0px;margin:0px;background:#fbfaff;border-bottom:1px solid #f3f3f5;cursor:default")
          //-p(style="float:left;padding-top:33px;padding-left:44px;margin:0px;font-size:1.6em;color:#1c7ef8;cursor:pointer") Done
          p(style="float:right;padding-top:33px;padding-right:44px;margin:0px;font-size:1.6em;color:#1c7ef8;cursor:pointer") Edit
          if sortPrimary === 'givenName'
            h1(style="text-align:center;padding-top:63px;margin:0px;font-size:3em") #{people[0][sortPrimary]} #{people[0][sortSecondary]}
          if sortPrimary === 'familyName'
            h1(style="text-align:center;padding-top:63px;margin:0px;font-size:3em") #{people[0][sortPrimary]}, #{people[0][sortSecondary]}
          p(style="text-align:center;padding-top:5px;margin:0px;font-size:1.4em;color:#808080;padding-bottom:11px;font-weight:300;") Updated 3 days ago
          /////////
          //ACTIONS
          /////////
          div(style="display: flex; justify-content: center;padding-bottom:55px;padding-top:11px;")
            div(style="background-color:#1c7ef8; height:4em; width:4em;border-radius:2em;margin:22px;margin-left:14px;cursor:pointer")
              span( class="fa fa-phone fa-2x" style="color:white;width:75%;height:75%;margin-top:0.55em;margin-left:0.62em;")
              p(style="text-align:center;padding:0px;margin-top:10px;color:#1c7ef8;font-family:'Roboto',sans-serif;font-size:1.4em;cursor:default") home
            //-div(style="background-color:#1c7ef8; height:4em; width:4em;border-radius:2em;margin:22px;margin-left:18px")
              span( class="fa fa-mobile fa-3x" style="color:white;width:75%;height:75%;margin-top:0.16em;margin-left:0.455em;cursor:pointer")
              p(style="text-align:center;padding-left:0px;margin-top:20px;color:#1c7ef8;font-family:'Roboto',sans-serif;font-size:1.4em;cursor:default") mobile
            div(style="background-color:#1c7ef8; height:4em; width:4em;border-radius:2em;margin:18px;margin-right:14px")
              span( class="fa fa-envelope fa-2x" style="color:white;width:75%;height:75%;margin-top:0.5em;margin-left:0.5em;cursor:pointer")
              p(style="text-align:center;padding-left:4px;margin-top:12px;color:#1c7ef8;font-family:'Roboto',sans-serif;font-size:1.4em;cursor:default") email
        ////////
        //CONTACT INFO
        /////////
        div(style="width:calc(100% - 132px); font-size:2em;padding:66px;padding-top:11px;padding-bottom:0px;margin:0px;background:white;cursor:default")
          p email:
          p(style="color:#3989e0;cursor:pointer") jose@barrios.io
          div(style="border: 1px solid #f3f3f5")
          p phone:
          p(style="color:#3989e0;cursor:pointer;") +1 (250) 588-8968
          div(style="border: 1px solid #f3f3f5")
          p(style="color:lightGray") Emergency Contacts:
          p Camille Graham (spouce)
          p(style="color:#fc3d39;cursor:pointer") +1 (555) 555-5555


script.
  var people = !{JSON.stringify(people)}
  var search = !{JSON.stringify(search)}
  var person = document.querySelector('.contact-list-person-container');
  var searchInput = document.querySelector('#roladexSearchInput');
  var deleteQueryButton = document.querySelector('#roladexSearchInputRightIcon');
  var allResultsContainer = document.querySelector('#contactListContainer');
  var filteredResultsContainer = document.querySelector('#searchResultListContainer');

  deleteQueryButton.addEventListener('click', function(e){
    searchInput.value = '';
    var event = document.createEvent('Event');
    event.initEvent('input', true, true);
    searchInput.dispatchEvent(event);
  })

  //////////
  //SEARCH//
  //////////
  searchInput.addEventListener('input', function(e){
    filteredResultsContainer.innerHTML = null;

    if(e.target.value){
      allResultsContainer.style.display = 'none';
      filteredResultsContainer.style.display = 'initial';
    } else{
      allResultsContainer.style.display = 'initial';
      filteredResultsContainer.style.display = 'none';
    }

    let found = [];
    people.forEach(person => {
      var givenName = person.givenName.toLowerCase();
      var familyName = person.familyName.toLowerCase();
      let query = e.target.value.toLowerCase();
      let fullName = `${givenName} ${familyName}`;
      if(fullName.includes(query)){
        found.push(person)
      }
    })

    ///////////
    //RENDER//
    //////////
    if(found.length){
      found.forEach(result => {
        var pElem = document.createElement("P");
        var textNode = document.createTextNode(result.givenName+result.familyName);
        pElem.appendChild(textNode);
        filteredResultsContainer.appendChild(pElem);
      })
    }
    else{
      var pElem = document.createElement("P");
      var textNode = document.createTextNode('None found');
      pElem.appendChild(textNode);
      filteredResultsContainer.appendChild(pElem);
    }
  })

  searchInput.value = search;
  var event = document.createEvent('Event');
  event.initEvent('input', true, true);
  searchInput.dispatchEvent(event);
